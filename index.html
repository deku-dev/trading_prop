<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="vanillatoasts.css">
    <script src="vanillatoasts.js"></script>
    <script>
        function updateNYTime() {
            const options = { timeZone: "America/New_York", hour12: false, hour: "2-digit", minute: "2-digit", second: "2-digit" };
            const timeString = new Intl.DateTimeFormat("en-US", options).format(new Date());
            document.getElementById("nyTime").innerText = "New York Time: " + timeString;
        }
        setInterval(updateNYTime, 1000);
    </script>
</head>
<body class="bg-gray-100 p-4 sm:p-6">
    <div id="nyTime" class="absolute top-4 right-4 bg-black text-white px-4 py-2 rounded shadow-md text-sm font-mono"></div>
    <div class="max-w-lg mx-auto bg-white p-6 rounded-lg shadow-md">
        <h1 class="text-2xl font-bold mb-4 text-center">Trade Calculator</h1>
        
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-1">Ticker Input</label>
            <input 
                id="tickerInput" 
                type="text" 
                placeholder="TICKER.EXCHANGE high low" 
                class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 p-2"
            >
            <button 
                onclick="calculateTrade()" 
                class="mt-3 w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700 transition-all"
            >
                Calculate
            </button>
        </div>

        <div id="resultsContainer" class="mt-4 p-4 bg-gray-50 rounded text-sm"></div>

        <div class="mt-6">
            <h2 class="text-lg font-semibold mb-2">Taken Positions</h2>
            <div 
                id="takenPositionsContainer" 
                class="border rounded p-4 bg-gray-50 max-h-48 overflow-y-auto text-sm"
            >
                <p id="noTakenPositionsMessage" class="text-gray-500">No positions taken yet</p>
            </div>
        </div>
        
        <div class="mt-6">
            <h2 class="text-lg font-semibold mb-2">Manage Risks</h2>
            <div class="space-y-2 sm:space-y-0 sm:space-x-2 sm:flex">
                <input 
                    id="riskNameInput" 
                    type="text" 
                    placeholder="Risk Name" 
                    class="w-full sm:w-auto flex-1 rounded-md border-gray-300 shadow-sm p-2"
                >
                <input 
                    id="riskValueInput" 
                    type="number" 
                    placeholder="Risk Value" 
                    class="w-full sm:w-auto flex-1 rounded-md border-gray-300 shadow-sm p-2"
                >
                <button 
                    onclick="setRisk()" 
                    class="w-full sm:w-auto bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-all"
                >
                    Add Risk
                </button>
            </div>
        </div>

        <div class="mt-6">
            <h2 class="text-lg font-semibold mb-2">Saved Risks</h2>
            <div 
                id="savedRisksContainer" 
                class="border rounded p-4 bg-gray-50 max-h-48 overflow-y-auto text-sm"
            >
                <p id="noRisksMessage" class="text-gray-500">No risks saved yet</p>
                <table id="risksTable" class="w-full hidden">
                    <thead>
                        <tr class="border-b">
                            <th class="text-left py-1">Risk Name</th>
                            <th class="text-right py-1">Value</th>
                            <th class="text-right py-1">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="risksTableBody"></tbody>
                </table>
            </div>
        </div>

        <div class="mt-6">
            <h2 class="text-lg font-semibold mb-2">Calculation History</h2>
            <div 
                id="calculationHistoryContainer" 
                class="border rounded p-4 bg-gray-50 max-h-48 overflow-y-auto text-sm"
            >
                <p id="noHistoryMessage" class="text-gray-500">No calculations yet</p>
                <table id="calculationHistoryTable" class="w-full hidden">
                    <thead>
                        <tr class="border-b">
                            <th class="text-left py-1">Ticker</th>
                            <th class="text-right py-1">Date</th>
                            <th class="text-right py-1">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="calculationHistoryTableBody"></tbody>
                </table>
            </div>
        </div>

        <div class="mt-4 flex space-x-2">
            <button 
                onclick="db.clearAllCalculations()" 
                class="w-full bg-red-500 text-white py-2 rounded hover:bg-red-600 transition-all"
            >
                Clear All Calculations
            </button>
            <button 
                onclick="db.clearAllTakenPositions()" 
                class="w-full bg-red-500 text-white py-2 rounded hover:bg-red-600 transition-all"
            >
                Clear All Taken Positions
            </button>
        </div>
    </div>

    <script src="trading_bot.js"></script>
</body>
</html>
